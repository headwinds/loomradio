{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/braflow/loomradio/src/players/Vimeo.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport { callPlayer, getSDK } from '../utils';\nimport createSinglePlayer from '../singlePlayer';\nvar SDK_URL = 'https://player.vimeo.com/api/player.js';\nvar SDK_GLOBAL = 'Vimeo';\nvar MATCH_URL = /vimeo\\.com\\/.+/;\nvar MATCH_FILE_URL = /vimeo\\.com\\/external\\/.+\\.mp4/;\nexport var Vimeo = /*#__PURE__*/function (_Component) {\n  _inherits(Vimeo, _Component);\n\n  var _super = _createSuper(Vimeo);\n\n  function Vimeo() {\n    var _this;\n\n    _classCallCheck(this, Vimeo);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"callPlayer\", callPlayer);\n\n    _defineProperty(_assertThisInitialized(_this), \"duration\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"currentTime\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"secondsLoaded\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"mute\", function () {\n      _this.setVolume(0);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"unmute\", function () {\n      if (_this.props.volume !== null) {\n        _this.setVolume(_this.props.volume);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"ref\", function (container) {\n      _this.container = container;\n    });\n\n    return _this;\n  }\n\n  _createClass(Vimeo, [{\n    key: \"load\",\n    value: function load(url) {\n      var _this2 = this;\n\n      this.duration = null;\n      getSDK(SDK_URL, SDK_GLOBAL).then(function (Vimeo) {\n        if (!_this2.container) return;\n        _this2.player = new Vimeo.Player(_this2.container, _objectSpread({\n          url: url,\n          autoplay: _this2.props.playing,\n          muted: _this2.props.muted,\n          loop: _this2.props.loop,\n          playsinline: _this2.props.playsinline\n        }, _this2.props.config.vimeo.playerOptions));\n\n        _this2.player.ready().then(function () {\n          var iframe = _this2.container.querySelector('iframe');\n\n          iframe.style.width = '100%';\n          iframe.style.height = '100%';\n        })[\"catch\"](_this2.props.onError);\n\n        _this2.player.on('loaded', function () {\n          _this2.props.onReady();\n\n          _this2.refreshDuration();\n        });\n\n        _this2.player.on('play', function () {\n          _this2.props.onPlay();\n\n          _this2.refreshDuration();\n        });\n\n        _this2.player.on('pause', _this2.props.onPause);\n\n        _this2.player.on('seeked', function (e) {\n          return _this2.props.onSeek(e.seconds);\n        });\n\n        _this2.player.on('ended', _this2.props.onEnded);\n\n        _this2.player.on('error', _this2.props.onError);\n\n        _this2.player.on('timeupdate', function (_ref) {\n          var seconds = _ref.seconds;\n          _this2.currentTime = seconds;\n        });\n\n        _this2.player.on('progress', function (_ref2) {\n          var seconds = _ref2.seconds;\n          _this2.secondsLoaded = seconds;\n        });\n      }, this.props.onError);\n    }\n  }, {\n    key: \"refreshDuration\",\n    value: function refreshDuration() {\n      var _this3 = this;\n\n      this.player.getDuration().then(function (duration) {\n        _this3.duration = duration;\n      });\n    }\n  }, {\n    key: \"play\",\n    value: function play() {\n      this.callPlayer('play');\n    }\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      this.callPlayer('pause');\n    }\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      this.callPlayer('unload');\n    }\n  }, {\n    key: \"seekTo\",\n    value: function seekTo(seconds) {\n      this.callPlayer('setCurrentTime', seconds);\n    }\n  }, {\n    key: \"setVolume\",\n    value: function setVolume(fraction) {\n      this.callPlayer('setVolume', fraction);\n    }\n  }, {\n    key: \"setLoop\",\n    value: function setLoop(loop) {\n      this.callPlayer('setLoop', loop);\n    }\n  }, {\n    key: \"getDuration\",\n    value: function getDuration() {\n      return this.duration;\n    }\n  }, {\n    key: \"getCurrentTime\",\n    value: function getCurrentTime() {\n      return this.currentTime;\n    }\n  }, {\n    key: \"getSecondsLoaded\",\n    value: function getSecondsLoaded() {\n      return this.secondsLoaded;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var style = _objectSpread({\n        width: '100%',\n        height: '100%',\n        overflow: 'hidden',\n        backgroundColor: 'black'\n      }, this.props.style);\n\n      return __jsx(\"div\", {\n        key: this.props.url,\n        ref: this.ref,\n        style: style,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 7\n        }\n      });\n    }\n  }]);\n\n  return Vimeo;\n}(Component);\n\n_defineProperty(Vimeo, \"displayName\", 'Vimeo');\n\n_defineProperty(Vimeo, \"canPlay\", function (url) {\n  if (MATCH_FILE_URL.test(url)) {\n    return false;\n  }\n\n  return MATCH_URL.test(url);\n});\n\nexport default _c = createSinglePlayer(Vimeo);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["/Users/braflow/loomradio/src/players/Vimeo.js"],"names":["React","Component","callPlayer","getSDK","createSinglePlayer","SDK_URL","SDK_GLOBAL","MATCH_URL","MATCH_FILE_URL","Vimeo","setVolume","props","volume","container","url","duration","then","player","Player","autoplay","playing","muted","loop","playsinline","config","vimeo","playerOptions","ready","iframe","querySelector","style","width","height","onError","on","onReady","refreshDuration","onPlay","onPause","e","onSeek","seconds","onEnded","currentTime","secondsLoaded","getDuration","fraction","overflow","backgroundColor","ref","test"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\n\nimport { callPlayer, getSDK } from '../utils'\nimport createSinglePlayer from '../singlePlayer'\n\nconst SDK_URL = 'https://player.vimeo.com/api/player.js'\nconst SDK_GLOBAL = 'Vimeo'\nconst MATCH_URL = /vimeo\\.com\\/.+/\nconst MATCH_FILE_URL = /vimeo\\.com\\/external\\/.+\\.mp4/\n\nexport class Vimeo extends Component {\n  static displayName = 'Vimeo'\n  static canPlay = url => {\n    if (MATCH_FILE_URL.test(url)) {\n      return false\n    }\n    return MATCH_URL.test(url)\n  }\n\n  callPlayer = callPlayer\n  duration = null\n  currentTime = null\n  secondsLoaded = null\n  load (url) {\n    this.duration = null\n    getSDK(SDK_URL, SDK_GLOBAL).then(Vimeo => {\n      if (!this.container) return\n      this.player = new Vimeo.Player(this.container, {\n        url,\n        autoplay: this.props.playing,\n        muted: this.props.muted,\n        loop: this.props.loop,\n        playsinline: this.props.playsinline,\n        ...this.props.config.vimeo.playerOptions\n      })\n      this.player.ready().then(() => {\n        const iframe = this.container.querySelector('iframe')\n        iframe.style.width = '100%'\n        iframe.style.height = '100%'\n      }).catch(this.props.onError)\n      this.player.on('loaded', () => {\n        this.props.onReady()\n        this.refreshDuration()\n      })\n      this.player.on('play', () => {\n        this.props.onPlay()\n        this.refreshDuration()\n      })\n      this.player.on('pause', this.props.onPause)\n      this.player.on('seeked', e => this.props.onSeek(e.seconds))\n      this.player.on('ended', this.props.onEnded)\n      this.player.on('error', this.props.onError)\n      this.player.on('timeupdate', ({ seconds }) => {\n        this.currentTime = seconds\n      })\n      this.player.on('progress', ({ seconds }) => {\n        this.secondsLoaded = seconds\n      })\n    }, this.props.onError)\n  }\n  refreshDuration () {\n    this.player.getDuration().then(duration => {\n      this.duration = duration\n    })\n  }\n  play () {\n    this.callPlayer('play')\n  }\n  pause () {\n    this.callPlayer('pause')\n  }\n  stop () {\n    this.callPlayer('unload')\n  }\n  seekTo (seconds) {\n    this.callPlayer('setCurrentTime', seconds)\n  }\n  setVolume (fraction) {\n    this.callPlayer('setVolume', fraction)\n  }\n  setLoop (loop) {\n    this.callPlayer('setLoop', loop)\n  }\n  mute = () => {\n    this.setVolume(0)\n  }\n  unmute = () => {\n    if (this.props.volume !== null) {\n      this.setVolume(this.props.volume)\n    }\n  }\n  getDuration () {\n    return this.duration\n  }\n  getCurrentTime () {\n    return this.currentTime\n  }\n  getSecondsLoaded () {\n    return this.secondsLoaded\n  }\n  ref = container => {\n    this.container = container\n  }\n  render () {\n    const style = {\n      width: '100%',\n      height: '100%',\n      overflow: 'hidden',\n      backgroundColor: 'black',\n      ...this.props.style\n    }\n    return (\n      <div\n        key={this.props.url}\n        ref={this.ref}\n        style={style}\n      />\n    )\n  }\n}\n\nexport default createSinglePlayer(Vimeo)\n"]},"metadata":{},"sourceType":"module"}